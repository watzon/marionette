<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 0.34.0">
<meta name="crystal_docs.project_version" content="master">
<meta name="crystal_docs.project_name" content="marionette">


<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>

  <meta id="repository-name" content="marionette">
  <title>marionette master</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          marionette
        </a>
      </h1>

      <span class="project-version">
        master
      </span>
    </div>
  </div>

  <div class="search-results" class="hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="marionette/HTTP" data-name="http">
      <a href="HTTP.html">HTTP</a>
      
        <ul>
  
  <li class=" " data-id="marionette/HTTP/Cookie" data-name="http::cookie">
      <a href="HTTP/Cookie.html">Cookie</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="marionette/Marionette" data-name="marionette">
      <a href="Marionette.html">Marionette</a>
      
        <ul>
  
  <li class="parent " data-id="marionette/Marionette/Action" data-name="marionette::action">
      <a href="Marionette/Action.html">Action</a>
      
        <ul>
  
  <li class=" " data-id="marionette/Marionette/Action/KeyDown" data-name="marionette::action::keydown">
      <a href="Marionette/Action/KeyDown.html">KeyDown</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/KeyPause" data-name="marionette::action::keypause">
      <a href="Marionette/Action/KeyPause.html">KeyPause</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/KeyUp" data-name="marionette::action::keyup">
      <a href="Marionette/Action/KeyUp.html">KeyUp</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/PointerCancel" data-name="marionette::action::pointercancel">
      <a href="Marionette/Action/PointerCancel.html">PointerCancel</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/PointerDown" data-name="marionette::action::pointerdown">
      <a href="Marionette/Action/PointerDown.html">PointerDown</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/PointerMove" data-name="marionette::action::pointermove">
      <a href="Marionette/Action/PointerMove.html">PointerMove</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/PointerPause" data-name="marionette::action::pointerpause">
      <a href="Marionette/Action/PointerPause.html">PointerPause</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/PointerUp" data-name="marionette::action::pointerup">
      <a href="Marionette/Action/PointerUp.html">PointerUp</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Action/SourceType" data-name="marionette::action::sourcetype">
      <a href="Marionette/Action/SourceType.html">SourceType</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="marionette/Marionette/ActionBuilder" data-name="marionette::actionbuilder">
      <a href="Marionette/ActionBuilder.html">ActionBuilder</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Browser" data-name="marionette::browser">
      <a href="Marionette/Browser.html">Browser</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/DriverOptions" data-name="marionette::driveroptions">
      <a href="Marionette/DriverOptions.html">DriverOptions</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Element" data-name="marionette::element">
      <a href="Marionette/Element.html">Element</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/ElementScrollBehavior" data-name="marionette::elementscrollbehavior">
      <a href="Marionette/ElementScrollBehavior.html">ElementScrollBehavior</a>
      
    </li>
  
  <li class="parent " data-id="marionette/Marionette/Error" data-name="marionette::error">
      <a href="Marionette/Error.html">Error</a>
      
        <ul>
  
  <li class=" " data-id="marionette/Marionette/Error/ElementClickIntercepted" data-name="marionette::error::elementclickintercepted">
      <a href="Marionette/Error/ElementClickIntercepted.html">ElementClickIntercepted</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/ElementIsNotSelectable" data-name="marionette::error::elementisnotselectable">
      <a href="Marionette/Error/ElementIsNotSelectable.html">ElementIsNotSelectable</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/ElementNotInteractable" data-name="marionette::error::elementnotinteractable">
      <a href="Marionette/Error/ElementNotInteractable.html">ElementNotInteractable</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/ElementNotVisible" data-name="marionette::error::elementnotvisible">
      <a href="Marionette/Error/ElementNotVisible.html">ElementNotVisible</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/GenericError" data-name="marionette::error::genericerror">
      <a href="Marionette/Error/GenericError.html">GenericError</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/ImeEngineActivationFailed" data-name="marionette::error::imeengineactivationfailed">
      <a href="Marionette/Error/ImeEngineActivationFailed.html">ImeEngineActivationFailed</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/ImeNotAvailable" data-name="marionette::error::imenotavailable">
      <a href="Marionette/Error/ImeNotAvailable.html">ImeNotAvailable</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InsecureCertificate" data-name="marionette::error::insecurecertificate">
      <a href="Marionette/Error/InsecureCertificate.html">InsecureCertificate</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidArgument" data-name="marionette::error::invalidargument">
      <a href="Marionette/Error/InvalidArgument.html">InvalidArgument</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidCookieDomain" data-name="marionette::error::invalidcookiedomain">
      <a href="Marionette/Error/InvalidCookieDomain.html">InvalidCookieDomain</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidCoordinates" data-name="marionette::error::invalidcoordinates">
      <a href="Marionette/Error/InvalidCoordinates.html">InvalidCoordinates</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidElementCoordinates" data-name="marionette::error::invalidelementcoordinates">
      <a href="Marionette/Error/InvalidElementCoordinates.html">InvalidElementCoordinates</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidElementState" data-name="marionette::error::invalidelementstate">
      <a href="Marionette/Error/InvalidElementState.html">InvalidElementState</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidSelector" data-name="marionette::error::invalidselector">
      <a href="Marionette/Error/InvalidSelector.html">InvalidSelector</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidSessionId" data-name="marionette::error::invalidsessionid">
      <a href="Marionette/Error/InvalidSessionId.html">InvalidSessionId</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidXpathSelector" data-name="marionette::error::invalidxpathselector">
      <a href="Marionette/Error/InvalidXpathSelector.html">InvalidXpathSelector</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/InvalidXpathSelectorReturnTyper" data-name="marionette::error::invalidxpathselectorreturntyper">
      <a href="Marionette/Error/InvalidXpathSelectorReturnTyper.html">InvalidXpathSelectorReturnTyper</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/JavascriptError" data-name="marionette::error::javascripterror">
      <a href="Marionette/Error/JavascriptError.html">JavascriptError</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/MethodNotAllowed" data-name="marionette::error::methodnotallowed">
      <a href="Marionette/Error/MethodNotAllowed.html">MethodNotAllowed</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/MoveTargetOutOfBounds" data-name="marionette::error::movetargetoutofbounds">
      <a href="Marionette/Error/MoveTargetOutOfBounds.html">MoveTargetOutOfBounds</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/NoAlertOpen" data-name="marionette::error::noalertopen">
      <a href="Marionette/Error/NoAlertOpen.html">NoAlertOpen</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/NoSuchCookie" data-name="marionette::error::nosuchcookie">
      <a href="Marionette/Error/NoSuchCookie.html">NoSuchCookie</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/NoSuchElement" data-name="marionette::error::nosuchelement">
      <a href="Marionette/Error/NoSuchElement.html">NoSuchElement</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/NoSuchFrame" data-name="marionette::error::nosuchframe">
      <a href="Marionette/Error/NoSuchFrame.html">NoSuchFrame</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/NoSuchWindow" data-name="marionette::error::nosuchwindow">
      <a href="Marionette/Error/NoSuchWindow.html">NoSuchWindow</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/ReachedErrorPage" data-name="marionette::error::reachederrorpage">
      <a href="Marionette/Error/ReachedErrorPage.html">ReachedErrorPage</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/ScriptTimeout" data-name="marionette::error::scripttimeout">
      <a href="Marionette/Error/ScriptTimeout.html">ScriptTimeout</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/SessionNotCreated" data-name="marionette::error::sessionnotcreated">
      <a href="Marionette/Error/SessionNotCreated.html">SessionNotCreated</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/StaleElementReference" data-name="marionette::error::staleelementreference">
      <a href="Marionette/Error/StaleElementReference.html">StaleElementReference</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/Timeout" data-name="marionette::error::timeout">
      <a href="Marionette/Error/Timeout.html">Timeout</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/UnableToCaptureScreen" data-name="marionette::error::unabletocapturescreen">
      <a href="Marionette/Error/UnableToCaptureScreen.html">UnableToCaptureScreen</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/UnableToSetCookie" data-name="marionette::error::unabletosetcookie">
      <a href="Marionette/Error/UnableToSetCookie.html">UnableToSetCookie</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/UnexpectedAlertOpen" data-name="marionette::error::unexpectedalertopen">
      <a href="Marionette/Error/UnexpectedAlertOpen.html">UnexpectedAlertOpen</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/UnknownCommand" data-name="marionette::error::unknowncommand">
      <a href="Marionette/Error/UnknownCommand.html">UnknownCommand</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/UnknownError" data-name="marionette::error::unknownerror">
      <a href="Marionette/Error/UnknownError.html">UnknownError</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/UnknownMethod" data-name="marionette::error::unknownmethod">
      <a href="Marionette/Error/UnknownMethod.html">UnknownMethod</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Error/XpathLookupError" data-name="marionette::error::xpathlookuperror">
      <a href="Marionette/Error/XpathLookupError.html">XpathLookupError</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Key" data-name="marionette::key">
      <a href="Marionette/Key.html">Key</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Location" data-name="marionette::location">
      <a href="Marionette/Location.html">Location</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/LocationStrategy" data-name="marionette::locationstrategy">
      <a href="Marionette/LocationStrategy.html">LocationStrategy</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Logger" data-name="marionette::logger">
      <a href="Marionette/Logger.html">Logger</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/LogItem" data-name="marionette::logitem">
      <a href="Marionette/LogItem.html">LogItem</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/MouseButton" data-name="marionette::mousebutton">
      <a href="Marionette/MouseButton.html">MouseButton</a>
      
    </li>
  
  <li class="parent " data-id="marionette/Marionette/Origin" data-name="marionette::origin">
      <a href="Marionette/Origin.html">Origin</a>
      
        <ul>
  
  <li class=" " data-id="marionette/Marionette/Origin/Element" data-name="marionette::origin::element">
      <a href="Marionette/Origin/Element.html">Element</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Origin/ElementSelector" data-name="marionette::origin::elementselector">
      <a href="Marionette/Origin/ElementSelector.html">ElementSelector</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Origin/Pointer" data-name="marionette::origin::pointer">
      <a href="Marionette/Origin/Pointer.html">Pointer</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Origin/ViewPort" data-name="marionette::origin::viewport">
      <a href="Marionette/Origin/ViewPort.html">ViewPort</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="marionette/Marionette/PageLoadStrategy" data-name="marionette::pageloadstrategy">
      <a href="Marionette/PageLoadStrategy.html">PageLoadStrategy</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/PointerType" data-name="marionette::pointertype">
      <a href="Marionette/PointerType.html">PointerType</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Rect" data-name="marionette::rect">
      <a href="Marionette/Rect.html">Rect</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Service" data-name="marionette::service">
      <a href="Marionette/Service.html">Service</a>
      
    </li>
  
  <li class="parent " data-id="marionette/Marionette/Session" data-name="marionette::session">
      <a href="Marionette/Session.html">Session</a>
      
        <ul>
  
  <li class=" " data-id="marionette/Marionette/Session/NetworkConditions" data-name="marionette::session::networkconditions">
      <a href="Marionette/Session/NetworkConditions.html">NetworkConditions</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Session/Orientation" data-name="marionette::session::orientation">
      <a href="Marionette/Session/Orientation.html">Orientation</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Session/Type" data-name="marionette::session::type">
      <a href="Marionette/Session/Type.html">Type</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Size" data-name="marionette::size">
      <a href="Marionette/Size.html">Size</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/Utils" data-name="marionette::utils">
      <a href="Marionette/Utils.html">Utils</a>
      
    </li>
  
  <li class=" " data-id="marionette/Marionette/WebDriver" data-name="marionette::webdriver">
      <a href="Marionette/WebDriver.html">WebDriver</a>
      
    </li>
  
  <li class="parent " data-id="marionette/Marionette/Window" data-name="marionette::window">
      <a href="Marionette/Window.html">Window</a>
      
        <ul>
  
  <li class=" " data-id="marionette/Marionette/Window/Type" data-name="marionette::window::type">
      <a href="Marionette/Window/Type.html">Type</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="marionette" class="anchor" href="#marionette">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Marionette</h1>

<p>&lt;div align="center">
  &lt;img src="./assets/code.png">
&lt;/div></p>

<p>Marionette is a one-size-fits-all approach to WebDriver adapters. It works with most all web driver implementations, including:</p>

<ul><li>[x] Chrome</li><li>[x] Chromium</li><li>[x] Firefox</li><li>[x] Safari</li><li>[x] Edge</li><li>[x] Internet Explorer</li><li>[x] Opera</li><li>[x] PhantomJS</li><li>[x] Webkit GTK</li><li>[x] WPE Webkit</li><li>[x] Android</li></ul>

<h2><a id="table-of-contents" class="anchor" href="#table-of-contents">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Table of Contents</h2>

<ul><li><a href="#installation" target="_blank">Installation</a></li><li><a href="#webdriver" target="_blank">WebDriver</a></li><ul><li><a href="#firefox" target="_blank">Firefox</a></li><li><a href="#chrome" target="_blank">Chrome</a></li><li><a href="#opera" target="_blank">Opera</a></li><li><a href="#safari" target="_blank">Safari</a></li><li><a href="#edge" target="_blank">Edge</a></li><li><a href="#internet-explorer" target="_blank">Internet Explorer</a></li></ul><li><a href="#getting-started" target="_blank">Getting Started</a></li><ul><li><a href="#driver-options" target="_blank">Driver Options</a></li></ul><li><a href="#browser-manipulation" target="_blank">Browser Manipulation</a></li><ul><li><a href="#navigation" target="_blank">Navigation</a></li><li><a href="#windows-and-tabs" target="_blank">Windows and Tabs</a></li><li><a href="#frames-and-iframes" target="_blank">Frames and IFrames</a></li><li><a href="#window-management" target="_blank">Window Management</a></li></ul><li><a href="#working-with-elements" target="_blank">Working with Elements</a></li></ul>

<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>

<ol><li>Make sure you have Crystal installed. This is a Crystal project and Crystal is required for usage. If you don't have it installed, see https://crystal-lang.org.</li></ol>

<ol><li>Add Marionette to an existing project by adding the dependency to your <code>shard.yml</code></li></ol>

<p><code></code>`yml
   dependencies:</p>

<pre><code> marionette:
   github: watzon<span class="s">/marionette
   branch: master</span></code></pre>

<p><code></code>`</p>

<ol><li>Run <code>shards install</code> to download and install Marionette as a dependency.</li></ol>

<ol><li>Download and have installed at least one <a href="https://www.w3.org/TR/webdriver/" target="_blank">WebDriver</a>. See the <a href="#WebDriver" target="_blank">#webdriver</a> section below for links to various downloads.</li></ol>

<h2><a id="web-driver" class="anchor" href="#web-driver">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>WebDriver</h2>

<p>WebDriver is a protocol which allows browser implementations to be remote controlled via a common interface. It's because of this functionality that frameworks like Marionette are possible. To use the protocol you first have to have installed one of the many WebDriver implementations, here are some of those:</p>

<h3><a id="firefox" class="anchor" href="#firefox">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Firefox</h3>

<p>GeckoDriver is implemented and supported by Mozilla directly.</p>

<ul><li><a href="https://github.com/mozilla/geckodriver/releases" target="_blank">Downloads</a></li><li><a href="https://firefox-source-docs.mozilla.org/testing/geckodriver/Support.html" target="_blank">Documentation</a></li></ul>

<h3><a id="chrome" class="anchor" href="#chrome">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Chrome</h3>

<p>ChromeDriver is implemented and supported by the Chromium Project.</p>

<ul><li><a href="https://sites.google.com/a/chromium.org/chromedriver/downloads" target="_blank">Downloads</a></li><li><a href="https://sites.google.com/a/chromium.org/chromedriver/" target="_blank">Documentation</a></li></ul>

<h3><a id="opera" class="anchor" href="#opera">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Opera</h3>

<p>OperaChromiumDriver is implemented and supported by Opera Software.</p>

<ul><li><a href="https://github.com/operasoftware/operachromiumdriver/releases" target="_blank">Downloads</a></li><li><a href="https://github.com/operasoftware/operachromiumdriver/releases" target="_blank">Documentation</a></li></ul>

<h3><a id="safari" class="anchor" href="#safari">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Safari</h3>

<p>SafariDriver is implemented and supported directy by Apple. It comes pre-installed with Safari and Safari Technology Preview.</p>

<ul><li><a href="https://developer.apple.com/documentation/webkit/about_webdriver_for_safari" target="_blank">Documentation</a></li></ul>

<h3><a id="edge" class="anchor" href="#edge">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Edge</h3>

<p>Microsoft is implementing and maintaining the Microsoft Edge WebDriver.</p>

<ul><li><a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/#downloads" target="_blank">Downloads</a></li><li><a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver" target="_blank">Documentation</a></li></ul>

<h3><a id="internet-explorer" class="anchor" href="#internet-explorer">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Internet Explorer</h3>

<p>Only version 11 is supported, and it requires additional <a href="https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver#required-configuration" target="_blank">configuration</a>.</p>

<p><strong>Note:</strong> Marionette specific configuration instructions coming soon.</p>

<h2><a id="getting-started" class="anchor" href="#getting-started">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Getting Started</h2>

<p>The goal of Marionette is simplicity, which is why it's written in Crystal. Once you have a webdriver installed and sitting comfortably on your path, using it couldn't be easier:</p>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;marionette&quot;</span>

session <span class="o">=</span> <span class="t">Marionette</span><span class="t">::</span><span class="t">WebDriver</span>.create_session(<span class="n">:chrome</span>)

<span class="c"># Navigate to crystal-lang.org</span>
session.navigate(<span class="s">&quot;https://crystal-lang.org&quot;</span>)

<span class="c"># Start an action chain and perform it</span>
session.perform_actions <span class="k">do</span>
  <span class="c"># Click the &quot;INSTALL&quot; link</span>
  click <span class="s">&quot;.main-actions a:nth-child(1)&quot;</span>
<span class="k">end</span>

sleep <span class="n">5</span>
session.close</code></pre>

<h3><a id="driver-capabilities" class="anchor" href="#driver-capabilities">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Driver Capabilities</h3>

<p>Different drivers have different capabilities available to them. To make setting them a little easier, there's the <code>DriverOptions</code> module which is extended by <code><a href="Marionette.html">Marionette</a></code> itself. Take, for instance, Chrome:</p>

<pre><code class="language-crystal"><span class="c"># Make this instance headless</span>
options <span class="o">=</span> <span class="t">Marionette</span>.chrome_options(args: [<span class="s">&quot;headless&quot;</span>])

<span class="c"># Create a Chrome session</span>
session <span class="o">=</span> <span class="t">Marionette</span><span class="t">::</span><span class="t">WebDriver</span>.create_session(<span class="n">:chrome</span>, capabilities: options)</code></pre>

<p><code>args</code> in this case are arguments to be passed to the browser itself rather than the driver. If you wish to pass arguments to the driver you can use the <code>args</code> parameter in the <code>create_session</code> method.</p>

<h2><a id="browser-manipulation" class="anchor" href="#browser-manipulation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Browser Manipulation</h2>

<p>As shown above, you can initialize a new driver session for whatever driver you want using <code>Marionette::WebDriver.create_session</code>, the first and most important argument to which is <code>:browser</code>. Browser can be any of <code>:chrome</code>, <code>:firefox</code>, <code>:opera</code>, <code>:safari</code>, <code>:edge</code>, <code>:internet_explorer</code>, <code>:webkit_gtk</code>, <code>:wpe_webkit</code>, or <code>:android</code>.</p>

<p>If the driver for the chosen browser is installed under its usual name that should be all you need to do, if not you may need to provide the binary location via the <code>:exe_path</code> argument. Other notable arguments are:</p>

<ul><li><code>:port</code> - sets the port you want the driver to listen on</li><li><code>:env</code>  - a hash of environment variables for the driver to be aware of</li><li><code>:args</code> - a string array of arguments to pass to the webdriver process</li><li><code>:options</code> - a JSON compatible structure containing browser options. see <a href="./src/marionette/driver_options.cr" target="_blank">here</a> for some nice helpers.</li></ul>

<h3><a id="navigation" class="anchor" href="#navigation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Navigation</h3>

<h4><a id="navigate" class="anchor" href="#navigate">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#navigate</code></h4>

<p>The first thing you will want to do after launching a browser is to open your website. This can be achieved in a single line:</p>

<pre><code class="language-crystal">session.navigate(<span class="s">&quot;https://crystal-lang.org&quot;</span>)</code></pre>

<h4><a id="current-url" class="anchor" href="#current-url">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#current_url</code></h4>

<p>You can read the current URL from the browser’s address bar using:</p>

<pre><code class="language-crystal">session.current_url
<span class="c"># =&gt; https://crystal-lang.org</span></code></pre>

<h4><a id="back" class="anchor" href="#back">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#back</code></h4>

<p>Pressing the browser’s back button:</p>

<pre><code class="language-crystal">session.back</code></pre>

<h4><a id="forward" class="anchor" href="#forward">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#forward</code></h4>

<p>Pressing the browser’s forward button:</p>

<pre><code class="language-crystal">session.forward</code></pre>

<h4><a id="refresh" class="anchor" href="#refresh">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#refresh</code></h4>

<p>Refresh the current page:</p>

<pre><code class="language-crystal">session.refresh</code></pre>

<h4><a id="title" class="anchor" href="#title">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#title</code></h4>

<p>You can read the current page title from the browser:</p>

<pre><code class="language-crystal">session.title
<span class="c"># =&gt; Crystal | The Crystal Programming Language</span></code></pre>

<h3><a id="windows-and-tabs" class="anchor" href="#windows-and-tabs">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Windows and Tabs</h3>

<p>WebDriver does not make the distinction between windows and tabs. If your site opens a new tab or window, Marionette will let you work with it using a window handle. Each window has a unique identifier which remains persistent in a single session.</p>

<h4><a id="current-window" class="anchor" href="#current-window">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#current_window</code></h4>

<p>You can get the currently active window using:</p>

<pre><code class="language-crystal">session.current_window</code></pre>

<p>This returns a <code>Window</code> instance containing a handle and allowing certain functions to be performed directly on the window instance.</p>

<h4><a id="windows" class="anchor" href="#windows">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#windows</code></h4>

<p>You can get an array of all currently opened windows using:</p>

<pre><code class="language-crystal">session.windows</code></pre>

<h4><a id="new-window" class="anchor" href="#new-window">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#new_window</code></h4>

<p>You can create a new window or tab using:</p>

<pre><code class="language-crystal">session.new_window(<span class="n">:window</span>) <span class="c"># default</span>
session.new_window(<span class="n">:tab</span>)

<span class="c"># Or using the Window object</span>

<span class="t">Marionette</span><span class="t">::</span><span class="t">Window</span>.<span class="k">new</span>(<span class="n">:window</span>) <span class="c"># default</span>
<span class="t">Marionette</span><span class="t">::</span><span class="t">Window</span>.<span class="k">new</span>(<span class="n">:tab</span>)</code></pre>

<h4><a id="switch-to-window" class="anchor" href="#switch-to-window">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#switch_to_window</code></h4>

<p>To interact with other windows you have to switch to them, this can be done with:</p>

<pre><code class="language-crystal">session.switch_to_window(window)

<span class="c"># Or using the Window object</span>

window.switch</code></pre>

<h4><a id="close-window" class="anchor" href="#close-window">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#close_window</code></h4>

<p>When you are finished with a window or tab and it is not the last window or tab open in your browser, you should close it and switch back to the window you were using previously:</p>

<pre><code class="language-crystal">session.close_window(window)

<span class="c"># Or using the Window object</span>

window.close</code></pre>

<h4><a id="close-current-window" class="anchor" href="#close-current-window">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#close_current_window</code></h4>

<p>Think of this is a shortcut to <code>#close_window</code> but for the currently active window:</p>

<pre><code class="language-crystal">session.close_current_window</code></pre>

<h4><a id="stop" class="anchor" href="#stop">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#stop</code></h4>

<p>When you are finished with the browser session you should call <code>stop</code>, instead of <code>close</code>:</p>

<pre><code class="language-crystal">session.stop</code></pre>

<p>Stop will:</p>

<ul><li>Close all the windows and tabs associated with that WebDriver session</li><li>Close the browser process</li><li>Close the background driver process</li></ul>

<p>Stop will be automatically closed on process exit.</p>

<h3><a id="frames-and-i-frames" class="anchor" href="#frames-and-i-frames">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Frames and IFrames</h3>

<p>Frames are a now deprecated means of building a site layout from multiple documents on the same domain. You are unlikely to work with them unless you are working with an pre HTML5 webapp. Iframes allow the insertion of a document from an entirely different domain, and are still commonly used.</p>

<p>If you need to work with frames or iframes, WebDriver allows you to work with them in the same way. Consider a button within an iframe. If we inspect the element using the browser development tools, we might see the following:</p>

<pre><code class="language-html">&lt;div id="modal">
  &lt;iframe id="buttonframe" name="myframe"  src="https://watzon.github.io">
   &lt;button>Click here&lt;/button>
 &lt;/iframe>
&lt;/div></code></pre>

<p>If it was not for the iframe we would expect to click on the button using something like:</p>

<pre><code class="language-crystal">session.find_element!(<span class="s">&quot;button&quot;</span>).click</code></pre>

<p>However, if there are no buttons outside of the iframe, you might instead get a <em>no such element error</em>. This happens because Marionette is only aware of the elements in the top level document. To interact with the button, we will need to first switch to the frame, in a similar way to how we switch windows. WebDriver offers three ways of switching to a frame.</p>

<h4><a id="switch-to-frame" class="anchor" href="#switch-to-frame">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#switch_to_frame</code></h4>

<p>The <code>switch_to_frame</code> session method allows us to tell the WebDriver that we want to switch the page context to the given frame/iframe:</p>

<pre><code class="language-crystal"><span class="c"># Find the element</span>
iframe <span class="o">=</span> session.find_element!(<span class="s">&quot;#modal&gt;iframe&quot;</span>)

<span class="c"># Switch to the frame</span>
session.switch_to_frame(iframe)

<span class="c"># Now we can click the button</span>
session.find_element!(<span class="s">&quot;button&quot;</span>).click</code></pre>

<h4><a id="switch-to-parent-frame" class="anchor" href="#switch-to-parent-frame">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#switch_to_parent_frame</code></h4>

<p>If you're in a nested set of frames you can switch back to the parent frame using:</p>

<pre><code class="language-crystal">session.switch_to_parent_frame</code></pre>

<h4><a id="leave-frame" class="anchor" href="#leave-frame">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#leave_frame</code></h4>

<p>When you're done inside a frame and want to get back to the normal document context you can use:</p>

<pre><code class="language-crystal">session.leave_frame</code></pre>

<h3><a id="window-management" class="anchor" href="#window-management">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Window Management</h3>

<p>Screen resolution can impact how your web application renders, so WebDriver provides mechanisms for moving and resizing the browser window.</p>

<h4><a id="size" class="anchor" href="#size">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#size</code></h4>

<p>You can fetch window dimensions either collectively or individually:</p>

<pre><code class="language-crystal"><span class="c"># First get the current window</span>
window <span class="o">=</span> session.current_window

<span class="c"># Access dimensions individually</span>
width <span class="o">=</span> window.width
height <span class="o">=</span> window.height

<span class="c"># Or collectively as a Size object</span>
window.size
<span class="c"># =&gt; Size(width: 800.0, height: 600.0)</span></code></pre>

<h4><a id="resize-to" class="anchor" href="#resize-to">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#resize_to</code></h4>

<p>To resize the window:</p>

<pre><code class="language-crystal">window.resize_to(<span class="n">600</span>, <span class="n">800</span>)

<span class="c"># Or using an existing Size object `size`</span>

window.size <span class="o">=</span> size</code></pre>

<h4><a id="position" class="anchor" href="#position">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#position</code></h4>

<p>You can fetch the coordinates of the top left corner of the browser window:</p>

<pre><code class="language-crystal">window.position
<span class="c"># =&gt; Location(x: 0.0, y: 0.0)</span></code></pre>

<h4><a id="move-to" class="anchor" href="#move-to">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#move_to</code></h4>

<p>You can also easily set the position of the window:</p>

<pre><code class="language-crystal">window.move_to(<span class="n">250</span>, <span class="n">250</span>)

<span class="c"># Or using a Location object `location`</span>

window.position <span class="o">=</span> location</code></pre>

<h4><a id="maximize" class="anchor" href="#maximize">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#maximize</code></h4>

<p>To maximize the given window:</p>

<pre><code class="language-crystal">window.maximize</code></pre>

<h4><a id="minimize" class="anchor" href="#minimize">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#minimize</code></h4>

<p>To minimize the given window:</p>

<pre><code class="language-crystal">window.minimize</code></pre>

<h4><a id="fullscreen" class="anchor" href="#fullscreen">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#fullscreen</code></h4>

<p>To make the given window full screen:</p>

<pre><code class="language-crystal">window.fullscreen</code></pre>

<h2><a id="working-with-elements" class="anchor" href="#working-with-elements">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Working with Elements</h2>

<p><code>Element</code> represents a DOM element. WebElements can be found by searching from the document root using a WebDriver instance, or by searching under another <code>Element</code>.</p>

<p>WebDriver API provides built-in methods to find the WebElements which are based on different properties like ID, Name, Class, XPath, CSS Selectors, link Text, etc.</p>

<h4><a id="active-element" class="anchor" href="#active-element">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#active_element</code></h4>

<p>Get and return the active element:</p>

<pre><code class="language-crystal">session.active_element</code></pre>

<h4><a id="find-element" class="anchor" href="#find-element">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#find_element</code></h4>

<p><code>find_element</code> and <code>find_element!</code> are used to find and store references to page elements. The only difference between the two is that <code>find_element!</code> will throw an exception if the element is not found and will not be nil, whereas <code>find_element</code> will return nil if the element is not found.</p>

<pre><code class="language-crystal"><span class="c"># Get the search box element by name</span>
search_bar <span class="o">=</span> session.find_element!(<span class="s">&quot;q&quot;</span>, <span class="n">:name</span>)

<span class="c"># Peform an action</span>
search_bar.send_keys(<span class="s">&quot;Crystal programming language&quot;</span>)

<span class="c"># Click the submit button (using the default :css option this time)</span>
session.find_element!(<span class="s">&quot;button.submit&quot;</span>).click</code></pre>

<h4><a id="find-elements" class="anchor" href="#find-elements">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#find_elements</code></h4>

<p>Used to find an array of elements matching the given selector:</p>

<pre><code class="language-crystal"><span class="c"># Get all elements with the tag name &quot;p&quot;</span>
elements <span class="o">=</span> session.find_elements(<span class="s">&quot;p&quot;</span>, <span class="n">:tag_name</span>)

elements.each <span class="k">do</span> <span class="o">|</span>el<span class="o">|</span>
  puts el.text
<span class="k">end</span></code></pre>

<h4><a id="find-child" class="anchor" href="#find-child">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#find_child</code></h4>

<p>Used to find a child element within the context of parent element. Like <code>find_element</code> it has raising and non-raising varients:</p>

<pre><code class="language-crystal"><span class="c"># Find the search form</span>
form <span class="o">=</span> session.find_element!(<span class="s">&quot;form&quot;</span>, <span class="n">:tag_name</span>)

<span class="c"># Find the form&#39;s child search box</span>
search_bar <span class="o">=</span> form.find_child!(<span class="s">&quot;q&quot;</span>, <span class="n">:name</span>)

search_bar.send_keys(<span class="s">&quot;Crystal programming language&quot;</span>)</code></pre>

<h4><a id="find-children" class="anchor" href="#find-children">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>#find_children</code></h4>

<p>Just like <code>find_elements</code> and <code>find_child</code>:</p>

<pre><code class="language-crystal">element <span class="o">=</span> session.find_element!(<span class="s">&quot;div&quot;</span>, <span class="n">:tag_name</span>)

paragraphs <span class="o">=</span> element.find_children(<span class="s">&quot;p&quot;</span>, <span class="n">:tag_name</span>)

paragraphs.each <span class="k">do</span> <span class="o">|</span>para<span class="o">|</span>
  puts para.text
<span class="k">end</span></code></pre>

<h2><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h2>

<ol><li>Fork it ( https://github.com/watzon/marionette/fork )</li><li>Create your feature branch (git checkout -b my-new-feature)</li><li>Commit your changes (git commit -am 'Add some feature')</li><li>Push to the branch (git push origin my-new-feature)</li><li>Create a new Pull Request</li></ol>

<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>

<ul><li><a href="https://github.com/watzon" target="_blank">watzon</a>  - creator, maintainer</li></ul>
</div>
</body>
</html>
